<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>日本酒記録</title>
<script src="js/jquery-2.1.3.min.js"></script>
<link rel="stylesheet" href="css/kadai.css">
</head>
<body>
<header>
<h1>日本酒記録</h1>
</header>
<main>
<div class="input-area">
        <p>銘柄名：</p>
        <input type="text" id="key" placeholder="例：十四代 本丸">

        <p>感想：</p>
        <textarea id="memo" rows="4" placeholder="例：芳醇な香りと甘みが広がる。"></textarea>
        
        <ul class="btn-area">
            <li id="save">記録する</li>
            <li id="clear">クリア</li>
        </ul>
    </div>

</main>

<table id="list">
<!-- ここに追加データが挿入される -->
</table>

    
<script>
//1.Save クリックイベント
$("#save").on("click", function(){
    const key = $("#key").val();  //入力内容の取得
    const value = $("#memo").val();　//入力内容の取得

    localStorage.setItem(key, value);　//localStorageに保存
    
    const html =  '<tr><th>'+key+'</th><td>'+value+'</td><td class="delete-cell"><button class="delete-btn">削除</button></td></tr>';
    $("#list").append(html); //画面の一覧に追加する魔法

    $("#key").val("");  // 次の入力のために入力欄を空にする
    $("#memo").val("");  // 次の入力のために、入力欄を空に
});


//2.clear クリックイベント
$("#clear").on("click", function(){
    const k = $("#key").val();
    const m = $("#memo").val();
    localStorage.clear();
    $("#list").empty(); //テーブル内を空にする
});

//3.一列削除ボタンのクリックイベント 　※今回の魔法ポイント＝イベント委譲
$(document).on("click", ".delete-btn", function(){
    const key = $(this).closest("tr").find("th").text(); //行のthからkeyを取得
    localStorage.removeItem(key); //localStorageから削除
    $(this).closest("tr").remove(); //行を削除
});


//4.ページ読み込み：保存データ取得表示
for(let i=0; i<localStorage.length; i++){
    const key = localStorage.key(i); //key名取得 I何番目
    const value = localStorage.getItem(key); //値を取得
    const html = '<tr><th>'+key+'</th><td>'+value+'</td><td class="delete-cell"><button class="delete-btn">削除</button></td></tr>';
    $("#list").append(html);
}


</script>
<footer><small>No Sake, No Life.</small></footer>
</body>
</html>